git status
git commit -m "minor fig updates"
git config --global user.email “hander”@vt.edu”
git config --global user.name “hlwander”
git commit -m "minor fig updates"
git add
git add .
git commit -m "minor fig updates"
git push origin reproducible_bvr_glm
git push
pacman::p_load(purrr, readr, tagger, tidyr)
#change nml start date back to 2000
#make sure DO, zoops, and phytos are okay
# run the model
sim_folder = "./sims/spinup/baseline"
GLM3r::run_glm(sim_folder)
# set nml file
nc_file <- file.path("sims/spinup/baseline/output/output.nc")
var="NIT_amm"
var="NIT_nit"
field_file <- file.path('./field_data/field_chem_2DOCpools.csv') 
var="OXY_oxy"
field_file <- file.path('./field_data/CleanedObsOxy.csv') 
#var = "PHY_tchla"
#field_file <- file.path('./field_data/CleanedObsChla.csv') 
obs<-read.csv(field_file, header=TRUE) %>% #read in observed chemistry data
#get modeled concentrations for focal depths
mod<- glmtools::get_var(nc_file, var, reference="surface", z_out=0.1) %>%
compare<-merge(mod, obs, by=c("DateTime","Depth"))
compare<-na.omit(compare)
tempdf<-subset(compare, compare$Depth==0.1)
if(nrow(tempdf)>1){
}
# ------------------------------------------------------------------------#
# temp
obstemp<-read_csv('field_data/CleanedObsTemp.csv') |> 
modtemp <- glmtools::get_temp(nc_file, reference="surface", z_out=0.1) |> 
watertemp<-merge(modtemp, obstemp, by=c("DateTime","Depth")) |> 
# DO
obs_oxy<-read.csv('field_data/CleanedObsOxy.csv') |> 
mod_oxy <- glmtools::get_var(nc_file, "OXY_oxy", reference='surface', z_out=0.1) |> 
oxy_compare <- merge(mod_oxy, obs_oxy, by=c("DateTime","Depth")) |> 
# NH4
obs_nh4 <- read.csv('field_data/field_chem_2DOCpools.csv', header=TRUE) |> 
mod_nh4 <- glmtools::get_var(nc_file, "NIT_amm", reference="surface", z_out=0.1) |> 
nh4_compare<-merge(mod_nh4, obs_nh4, by=c("DateTime","Depth")) |> 
# NO3
obs_no3 <- read.csv('field_data/field_chem_2DOCpools.csv', header=TRUE) |> 
mod_no3 <- glmtools::get_var(nc_file, "NIT_nit", reference="surface", z_out=0.1) |> 
no3_compare<-merge(mod_no3, obs_no3, by=c("DateTime","Depth")) |> 
# PO4
obs_po4 <- read.csv('field_data/field_chem_2DOCpools.csv', header=TRUE) |> 
mod_po4 <- glmtools::get_var(nc_file, "PHS_frp", reference="surface", z_out=0.1) |> 
po4_compare<-merge(mod_po4, obs_po4, by=c("DateTime","Depth")) |> 
# chl a
obs_chla <- read.csv('field_data/CleanedObsChla.csv', header=TRUE) |> 
mod_chla <- glmtools::get_var(nc_file, "PHY_tchla", reference="surface", z_out=0.1) |> 
chla_compare<-merge(mod_chla, obs_chla, by=c("DateTime","Depth")) |> 
#-------------------------------------------------------------#
#merge all dfs
all_vars <- reduce(list(watertemp, oxy_compare,
mod_vars <- reduce(list(modtemp, mod_oxy,
#add col for calib vs. valid period (2020-12-31)
all_vars$period <- ifelse(all_vars$DateTime <= "2020-12-31",
#convert from wide to long for plotting
all_vars_final_baseline <- all_vars |> 
)
# Apply these labels as factor levels after defining them
all_vars_final_baseline <- all_vars_final_baseline |>
mod_vars_final_baseline <- mod_vars_final_baseline |>
mod_vars_final_baseline$var <- factor(mod_vars_final_baseline$var, 
# plot vars for 0.1m
ggplot() +
#ggsave("figures/allvars_mod_vs_obs_0.1m.jpg", width=6, height=6)
var="PHY_cyano"
# Function to get phyto data for varying depths
get_zoops <- function(depths, nc_file, var) {
# Define depth range and call the function
depths <- seq(0, 11, by = 0.5)
cyano_full_wc <- get_zoops(depths, nc_file, var)
#sum all depths
cyano <- cyano_full_wc |> 
var="PHY_green"
green_full_wc <- get_zoops(depths, nc_file, var)
#sum all depths
green <- green_full_wc |> 
var="PHY_diatom"
diatom_full_wc <- get_zoops(depths, nc_file, var)
#sum all depths
diatom <- diatom_full_wc |> 
#combine into one df 
all_phytos <- purrr::reduce(list(cyano, green, diatom), dplyr::full_join) 
#convert from wide to long for plotting
all_phytos_final <- all_phytos |> 
ggplot() +
#ggsave("figures/phytos_full_wc_baseline.jpg", width=6, height=6)
var= 'PHY_tchla'
pacman::p_load(purrr, readr, tagger, tidyr)
#change nml start date back to 2000
#make sure DO, zoops, and phytos are okay
# run the model
sim_folder = "./sims/spinup/baseline"
GLM3r::run_glm(sim_folder)
# set nml file
nc_file <- file.path("sims/spinup/baseline/output/output.nc")
var="NIT_amm"
var="NIT_nit"
field_file <- file.path('./field_data/field_chem_2DOCpools.csv') 
var="OXY_oxy"
field_file <- file.path('./field_data/CleanedObsOxy.csv') 
#var = "PHY_tchla"
#field_file <- file.path('./field_data/CleanedObsChla.csv') 
obs<-read.csv(field_file, header=TRUE) %>% #read in observed chemistry data
#get modeled concentrations for focal depths
mod<- glmtools::get_var(nc_file, var, reference="surface", z_out=0.1) %>%
compare<-merge(mod, obs, by=c("DateTime","Depth"))
compare<-na.omit(compare)
tempdf<-subset(compare, compare$Depth==0.1)
if(nrow(tempdf)>1){
}
# ------------------------------------------------------------------------#
# temp
obstemp<-read_csv('field_data/CleanedObsTemp.csv') |> 
modtemp <- glmtools::get_temp(nc_file, reference="surface", z_out=0.1) |> 
watertemp<-merge(modtemp, obstemp, by=c("DateTime","Depth")) |> 
# DO
obs_oxy<-read.csv('field_data/CleanedObsOxy.csv') |> 
mod_oxy <- glmtools::get_var(nc_file, "OXY_oxy", reference='surface', z_out=0.1) |> 
oxy_compare <- merge(mod_oxy, obs_oxy, by=c("DateTime","Depth")) |> 
# NH4
obs_nh4 <- read.csv('field_data/field_chem_2DOCpools.csv', header=TRUE) |> 
mod_nh4 <- glmtools::get_var(nc_file, "NIT_amm", reference="surface", z_out=0.1) |> 
nh4_compare<-merge(mod_nh4, obs_nh4, by=c("DateTime","Depth")) |> 
# NO3
obs_no3 <- read.csv('field_data/field_chem_2DOCpools.csv', header=TRUE) |> 
mod_no3 <- glmtools::get_var(nc_file, "NIT_nit", reference="surface", z_out=0.1) |> 
no3_compare<-merge(mod_no3, obs_no3, by=c("DateTime","Depth")) |> 
# PO4
obs_po4 <- read.csv('field_data/field_chem_2DOCpools.csv', header=TRUE) |> 
mod_po4 <- glmtools::get_var(nc_file, "PHS_frp", reference="surface", z_out=0.1) |> 
po4_compare<-merge(mod_po4, obs_po4, by=c("DateTime","Depth")) |> 
# chl a
obs_chla <- read.csv('field_data/CleanedObsChla.csv', header=TRUE) |> 
mod_chla <- glmtools::get_var(nc_file, "PHY_tchla", reference="surface", z_out=0.1) |> 
chla_compare<-merge(mod_chla, obs_chla, by=c("DateTime","Depth")) |> 
#-------------------------------------------------------------#
#merge all dfs
all_vars <- reduce(list(watertemp, oxy_compare,
mod_vars <- reduce(list(modtemp, mod_oxy,
#add col for calib vs. valid period (2020-12-31)
all_vars$period <- ifelse(all_vars$DateTime <= "2020-12-31",
#convert from wide to long for plotting
all_vars_final_baseline <- all_vars |> 
)
# Apply these labels as factor levels after defining them
all_vars_final_baseline <- all_vars_final_baseline |>
mod_vars_final_baseline <- mod_vars_final_baseline |>
mod_vars_final_baseline$var <- factor(mod_vars_final_baseline$var, 
# plot vars for 0.1m
ggplot() +
#ggsave("figures/allvars_mod_vs_obs_0.1m.jpg", width=6, height=6)
var="PHY_cyano"
# Function to get phyto data for varying depths
get_zoops <- function(depths, nc_file, var) {
# Define depth range and call the function
depths <- seq(0, 11, by = 0.5)
cyano_full_wc <- get_zoops(depths, nc_file, var)
#sum all depths
cyano <- cyano_full_wc |> 
var="PHY_green"
green_full_wc <- get_zoops(depths, nc_file, var)
#sum all depths
green <- green_full_wc |> 
var="PHY_diatom"
diatom_full_wc <- get_zoops(depths, nc_file, var)
#sum all depths
diatom <- diatom_full_wc |> 
#combine into one df 
all_phytos <- purrr::reduce(list(cyano, green, diatom), dplyr::full_join) 
#convert from wide to long for plotting
all_phytos_final <- all_phytos |> 
ggplot() +
#ggsave("figures/phytos_full_wc_baseline.jpg", width=6, height=6)
var= 'PHY_tchla'
pacman::p_load(purrr, readr, tagger, tidyr)
#change nml start date back to 2000
#make sure DO, zoops, and phytos are okay
# run the model
sim_folder = "./sims/spinup/baseline"
GLM3r::run_glm(sim_folder)
# set nml file
nc_file <- file.path("sims/spinup/baseline/output/output.nc")
var="NIT_amm"
var="NIT_nit"
field_file <- file.path('./field_data/field_chem_2DOCpools.csv') 
var="OXY_oxy"
field_file <- file.path('./field_data/CleanedObsOxy.csv') 
#var = "PHY_tchla"
#field_file <- file.path('./field_data/CleanedObsChla.csv') 
obs<-read.csv(field_file, header=TRUE) %>% #read in observed chemistry data
#get modeled concentrations for focal depths
mod<- glmtools::get_var(nc_file, var, reference="surface", z_out=0.1) %>%
compare<-merge(mod, obs, by=c("DateTime","Depth"))
compare<-na.omit(compare)
tempdf<-subset(compare, compare$Depth==0.1)
if(nrow(tempdf)>1){
}
# ------------------------------------------------------------------------#
# temp
obstemp<-read_csv('field_data/CleanedObsTemp.csv') |> 
modtemp <- glmtools::get_temp(nc_file, reference="surface", z_out=0.1) |> 
watertemp<-merge(modtemp, obstemp, by=c("DateTime","Depth")) |> 
# DO
obs_oxy<-read.csv('field_data/CleanedObsOxy.csv') |> 
mod_oxy <- glmtools::get_var(nc_file, "OXY_oxy", reference='surface', z_out=0.1) |> 
oxy_compare <- merge(mod_oxy, obs_oxy, by=c("DateTime","Depth")) |> 
# NH4
obs_nh4 <- read.csv('field_data/field_chem_2DOCpools.csv', header=TRUE) |> 
mod_nh4 <- glmtools::get_var(nc_file, "NIT_amm", reference="surface", z_out=0.1) |> 
nh4_compare<-merge(mod_nh4, obs_nh4, by=c("DateTime","Depth")) |> 
# NO3
obs_no3 <- read.csv('field_data/field_chem_2DOCpools.csv', header=TRUE) |> 
mod_no3 <- glmtools::get_var(nc_file, "NIT_nit", reference="surface", z_out=0.1) |> 
no3_compare<-merge(mod_no3, obs_no3, by=c("DateTime","Depth")) |> 
# PO4
obs_po4 <- read.csv('field_data/field_chem_2DOCpools.csv', header=TRUE) |> 
mod_po4 <- glmtools::get_var(nc_file, "PHS_frp", reference="surface", z_out=0.1) |> 
po4_compare<-merge(mod_po4, obs_po4, by=c("DateTime","Depth")) |> 
# chl a
obs_chla <- read.csv('field_data/CleanedObsChla.csv', header=TRUE) |> 
mod_chla <- glmtools::get_var(nc_file, "PHY_tchla", reference="surface", z_out=0.1) |> 
chla_compare<-merge(mod_chla, obs_chla, by=c("DateTime","Depth")) |> 
#-------------------------------------------------------------#
#merge all dfs
all_vars <- reduce(list(watertemp, oxy_compare,
mod_vars <- reduce(list(modtemp, mod_oxy,
#add col for calib vs. valid period (2020-12-31)
all_vars$period <- ifelse(all_vars$DateTime <= "2020-12-31",
#convert from wide to long for plotting
all_vars_final_baseline <- all_vars |> 
)
# Apply these labels as factor levels after defining them
all_vars_final_baseline <- all_vars_final_baseline |>
mod_vars_final_baseline <- mod_vars_final_baseline |>
mod_vars_final_baseline$var <- factor(mod_vars_final_baseline$var, 
# plot vars for 0.1m
ggplot() +
#ggsave("figures/allvars_mod_vs_obs_0.1m.jpg", width=6, height=6)
var="PHY_cyano"
# Function to get phyto data for varying depths
get_zoops <- function(depths, nc_file, var) {
# Define depth range and call the function
depths <- seq(0, 11, by = 0.5)
cyano_full_wc <- get_zoops(depths, nc_file, var)
#sum all depths
cyano <- cyano_full_wc |> 
var="PHY_green"
green_full_wc <- get_zoops(depths, nc_file, var)
#sum all depths
green <- green_full_wc |> 
var="PHY_diatom"
diatom_full_wc <- get_zoops(depths, nc_file, var)
#sum all depths
diatom <- diatom_full_wc |> 
#combine into one df 
all_phytos <- purrr::reduce(list(cyano, green, diatom), dplyr::full_join) 
#convert from wide to long for plotting
all_phytos_final <- all_phytos |> 
ggplot() +
#ggsave("figures/phytos_full_wc_baseline.jpg", width=6, height=6)
var= 'PHY_tchla'
obs<-read.csv('field_data/CleanedObsChla.csv', header=TRUE) |>  #read in observed chemistry data
compare<-na.omit(compare)
tempdf<-subset(compare, compare$Depth==0.1)
if(nrow(tempdf)>1){
}
git --version
git status
